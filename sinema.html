<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>Bir Marul Hikayesi ğŸ¥¬ â€“ Gala Gecesi</title>
  
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no" />

  <meta name="theme-color" content="#2b0208">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-capable" content="yes">

  <link
    href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@500;600&family=Poppins:wght@300;400;500;600&display=swap"
    rel="stylesheet"
  />

  <style>
    :root {
      /* Ä°stediÄŸin koyu kÄ±rmÄ±zÄ± tonu */
      --bg-red: #2b0208; 
      
      --ticket-bg: #fbf6ec;
      --ticket-border: #e4dbcf;
      --ticket-text: #22202a;
      --ticket-soft: #6c6674;
      --cc-accent: #f5b36b;
      --cc-accent-soft: #f07171;
      color-scheme: dark;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      /* Mobilde uzun basÄ±nca Ã§Ä±kan seÃ§imleri engelle */
      -webkit-tap-highlight-color: transparent;
    }

    html {
      width: 100%;
      height: 100%;
      /* Ã‡entik ve alt barÄ±n rengini burasÄ± belirler */
      background-color: var(--bg-red); 
    }

    body {
      width: 100%;
      height: 100%;
      /* Body de dÃ¼z kÄ±rmÄ±zÄ± olsun ki iOS kaydÄ±rmalarÄ±nda arkasÄ± kÄ±rmÄ±zÄ± gÃ¶rÃ¼nsÃ¼n */
      background-color: var(--bg-red);
      font-family: "Poppins", sans-serif;
      color: #f5f1ff;
      overflow: hidden;
      margin: 0;
      position: fixed; /* Mobilde sayfayÄ± sabitle */
      inset: 0;
    }

    .cinema {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1;
      /* Sinema karanlÄ±ÄŸÄ±nÄ± BURADA veriyoruz, body'de deÄŸil */
      background: radial-gradient(circle at 50% 30%, #5c0a16 0%, #2b0208 60%, #1a0105 100%);
    }

    .screen-wrapper {
      position: relative;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }

    /* IÅŸÄ±klar kÄ±sÄ±lÄ±nca sinema modu */
    .screen-wrapper::before {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 50% 50%, rgba(0,0,0,0.3) 0, rgba(0,0,0,0.95) 100%);
      opacity: 0;
      transition: opacity 1.2s ease;
      z-index: 0;
      pointer-events: none;
    }

    body.lights-dim .screen-wrapper::before {
      opacity: 1;
    }

    .screen {
      position: absolute;
      inset: 0;
      padding: min(3vw, 26px);
      /* Mobilde ekranÄ± biraz yukarÄ± ittik */
      padding-bottom: 160px; 
      display: flex;
      align-items: flex-end;
      justify-content: center;
      z-index: 1;
    }

    @media (max-width: 768px) {
      .screen {
        padding: 14px;
        padding-top: 60px; /* Ãœstten biraz boÅŸluk */
        padding-bottom: 100px;
        align-items: center;
      }
    }

    .screen-inner {
      position: relative;
      width: 100%;
      max-width: 1100px;
      aspect-ratio: 16 / 9;
      border-radius: 22px;
      background: #000;
      overflow: hidden;
      box-shadow: 0 24px 45px rgba(0, 0, 0, 0.6);
      z-index: 1;
    }

    .screen-video {
      position: absolute;
      inset: 0;
      background: #000;
      z-index: 1;
    }

    .screen-video video {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      pointer-events: none; /* Video tÄ±klamasÄ±nÄ± kapat, biz yÃ¶neteceÄŸiz */
    }

    /* BAÅLAT BUTONU */
    .top-start {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 20;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.35s ease;
    }

    .top-start.show {
      opacity: 1;
      pointer-events: auto;
    }

    .top-start-btn {
      border: none;
      outline: none;
      border-radius: 999px;
      /* Mobilde daha kibar boyutlar */
      padding: 10px 24px;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      font-family: inherit;
      background: linear-gradient(135deg, #f07171, #f5b36b);
      color: #190b0b;
      box-shadow: 0 10px 22px rgba(0, 0, 0, 0.6);
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    @media (max-width: 768px) {
        .top-start-btn {
            padding: 8px 16px; /* KÃ¼Ã§Ã¼ltÃ¼ldÃ¼ */
            font-size: 0.85rem;
            gap: 6px;
        }
    }

    .top-start-btn:active {
      transform: scale(0.96);
    }

    /* KONTROL Ã‡UBUÄU */
    .custom-controls {
      position: absolute;
      left: 14px;
      right: 14px;
      bottom: 10px; /* Biraz yukarÄ± aldÄ±k */
      padding: 6px 12px;
      border-radius: 999px;
      background: rgba(15, 10, 20, 0.85);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      align-items: center;
      gap: 10px;
      color: #fff;
      font-size: 0.75rem;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease, transform 0.3s ease;
      transform: translateY(10px);
      z-index: 6;
    }

    .custom-controls.visible {
      opacity: 1;
      pointer-events: auto;
      transform: translateY(0);
    }

    .cc-btn {
      background: none;
      border: none;
      color: inherit;
      font-size: 1.1rem;
      padding: 4px;
      cursor: pointer;
      display: flex;
      align-items: center;
    }

    .cc-progress-wrap {
      flex: 1;
      height: 20px;
      display: flex;
      align-items: center;
      cursor: pointer;
    }

    .cc-progress-bg {
      width: 100%;
      height: 4px;
      background: rgba(255,255,255,0.2);
      border-radius: 4px;
      position: relative;
      overflow: hidden;
    }

    .cc-progress-bar {
      position: absolute;
      top: 0;
      left: 0;
      height: 100%;
      width: 0%;
      background: #f5b36b;
      border-radius: 4px;
    }

    /* FÄ°LM BÄ°TTÄ° EKRANI */
    .end-overlay {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(0,0,0,0.85);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.5s ease;
      z-index: 10;
      padding: 20px;
    }

    .end-overlay.show {
      opacity: 1;
      pointer-events: auto;
    }

    .end-card {
      background: rgba(20, 15, 25, 0.95);
      border: 1px solid rgba(255, 255, 255, 0.15);
      border-radius: 20px;
      padding: 20px;
      text-align: center;
      max-width: 300px;
      width: 100%;
      box-shadow: 0 20px 50px rgba(0,0,0,0.8);
    }

    /* Mobilde yazÄ±larÄ±n tam sÄ±ÄŸmasÄ± iÃ§in kÃ¼Ã§Ã¼ltmeler */
    @media (max-width: 768px) {
        .end-card {
            padding: 16px;
            max-width: 260px; 
        }
        .end-title {
            font-size: 1rem;
            margin-bottom: 8px;
            color: #ffecd1;
        }
        .end-text {
            font-size: 0.8rem;
            line-height: 1.5;
            color: #dcdcdc;
            margin-bottom: 12px;
        }
    }

    .end-actions {
      display: flex;
      gap: 8px;
      justify-content: center;
    }

    .end-btn {
      border: none;
      border-radius: 50px;
      padding: 8px 16px;
      font-size: 0.8rem;
      cursor: pointer;
      font-family: inherit;
      font-weight: 500;
    }

    .end-btn.primary {
      background: #f07171;
      color: white;
    }
    
    .end-btn.ghost {
      background: transparent;
      border: 1px solid rgba(255,255,255,0.3);
      color: #fff;
    }

    /* PERDE */
    .curtain {
      position: absolute;
      inset: 0;
      display: flex;
      z-index: 3;
      pointer-events: none;
    }

    .curtain-panel {
      flex: 1;
      height: 100%;
      background:
        radial-gradient(circle at 50% -40%, rgba(255,255,255,0.1), transparent 60%),
        repeating-linear-gradient(90deg, #5a0711, #5a0711 20px, #8f0b1b 20px, #8f0b1b 40px);
      box-shadow: 0 0 50px rgba(0,0,0,0.9);
      transition: transform 1.5s cubic-bezier(0.2, 0.8, 0.2, 1);
    }

    .curtain.open .curtain-panel.left { transform: translateX(-100%); }
    .curtain.open .curtain-panel.right { transform: translateX(100%); }

    /* BÄ°LET ALANI */
    .ticket-layer {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 5;
      padding: 10px;
    }

    .ticket-visual {
      width: 100%;
      max-width: 340px; /* Mobilde dikey formata uygun */
      background: var(--ticket-bg);
      border-radius: 16px;
      color: var(--ticket-text);
      box-shadow: 0 20px 40px rgba(0,0,0,0.8);
      position: relative;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .ticket-top {
      padding: 24px;
      text-align: center;
      border-bottom: 2px dashed #d5c8b6;
      position: relative;
    }

    /* Bilet kenarÄ±ndaki yarÄ±m daireler */
    .ticket-top::before, .ticket-top::after {
      content: "";
      position: absolute;
      bottom: -10px;
      width: 20px;
      height: 20px;
      background: var(--bg-red); /* Arka planla aynÄ± renk */
      border-radius: 50%;
    }
    .ticket-top::before { left: -10px; }
    .ticket-top::after { right: -10px; }

    .ticket-title {
      font-family: "Dancing Script", cursive;
      font-size: 2rem;
      margin-bottom: 4px;
    }

    .ticket-info {
      margin-top: 15px;
      display: flex;
      justify-content: space-around;
      font-size: 0.85rem;
    }
    .ticket-info div { font-weight: 600; text-transform: uppercase; }
    .ticket-info span { display: block; font-weight: 400; color: var(--ticket-soft); font-size: 0.75rem; }

    .ticket-stub {
      padding: 15px;
      background: #f4efe4;
      text-align: center;
      cursor: grab;
      position: relative;
      transition: transform 0.1s;
      touch-action: none; /* SÃ¼rÃ¼kleme iÃ§in Ã¶nemli */
    }

    .ticket-stub:active { cursor: grabbing; }

    .drag-hint {
      font-size: 0.75rem;
      color: var(--ticket-soft);
      margin-top: 4px;
      animation: bounce 1.5s infinite;
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(3px); }
    }

    .ticket-gone {
      transition: transform 0.6s ease, opacity 0.6s ease;
      transform: translateY(100vh) rotate(10deg);
      opacity: 0;
    }

    /* ALT AÃ‡IKLAMA */
    .bottom-caption {
      position: absolute;
      bottom: 20px;
      left: 0; 
      right: 0;
      text-align: center;
      font-size: 0.75rem;
      color: rgba(255,255,255,0.6);
      pointer-events: none;
      z-index: 4;
      padding: 0 20px;
    }
    .bottom-caption.hide { opacity: 0; }

    /* SALON GÃ–RSELÄ° */
    .viewer-scene {
        position: fixed;
        bottom: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 100%;
        max-width: 600px;
        pointer-events: none;
        z-index: 2;
        display: flex;
        justify-content: center;
    }
    
    .viewer-scene img {
        width: 100%;
        height: auto;
        display: block;
    }

    .kiss-hotspot {
        position: absolute;
        bottom: 10%;
        left: 40%;
        width: 20%;
        height: 50%;
        background: transparent;
        border: none;
        pointer-events: auto;
    }

  </style>
</head>
<body>

  <div class="cinema">
    <div class="screen-wrapper">
      
      <div class="curtain" id="curtain">
        <div class="curtain-panel left"></div>
        <div class="curtain-panel right"></div>
      </div>

      <div class="screen">
        <div class="screen-inner">
          <div class="screen-video">
            <video id="love-film" playsinline webkit-playsinline preload="auto" poster="poster.png">
              <source src="film.mp4" type="video/mp4" />
            </video>
          </div>

          <div class="top-start" id="top-start">
            <button class="top-start-btn" id="top-start-btn" type="button">
              <span>â–¶ Filmi BaÅŸlat</span>
            </button>
          </div>

          <div class="custom-controls" id="custom-controls">
            <button class="cc-btn" id="btn-play">â–¶</button>
            <div class="cc-progress-wrap" id="cc-progress-bg">
              <div class="cc-progress-bg">
                <div class="cc-progress-bar" id="cc-progress"></div>
              </div>
            </div>
            <div style="font-size: 0.7rem; margin-left:8px;" id="cc-time">0:00</div>
            <button class="cc-btn" id="btn-mute">ğŸ”Š</button>
            <button class="cc-btn" id="btn-fullscreen">â›¶</button>
          </div>

          <div class="end-overlay" id="end-overlay">
            <div class="end-card">
              <h3 class="end-title">FÄ°LM BÄ°TTÄ° ğŸ¬</h3>
              <p class="end-text">
                BaÅŸrol: Sen<br>
                Yrd. Oyuncu: Ben<br>
                TeÅŸekkÃ¼rler: Marul ğŸ¥¬
              </p>
              <div class="end-actions">
                <button class="end-btn primary" id="btn-rewatch">Tekrar Ä°zle</button>
                <button class="end-btn ghost" id="btn-save-ticket">Bileti Sakla</button>
              </div>
            </div>
          </div>

        </div>
      </div>

      <div class="viewer-scene">
        <button class="kiss-hotspot" id="kiss-hotspot"></button>
        <img id="viewer-scene-img" src="salon.png" alt="Salon">
      </div>

      <div class="ticket-layer" id="ticket-layer">
        <div class="ticket-visual" id="ticket-visual">
          <div class="ticket-top">
            <div style="font-size:0.7rem; color:#6c6674; margin-bottom:5px;">MANITA CINEMA</div>
            <div class="ticket-title">Bir Marul Hikayesi ğŸ¥¬</div>
            <div style="font-size:0.8rem; color:#6c6674;">1 Ocak 2026</div>
            
            <div class="ticket-info">
              <div>
                <span>SALON</span>
                26
              </div>
              <div>
                <span>SIRA</span>
                YAN YANA
              </div>
            </div>
          </div>
          <div class="ticket-stub" id="ticket-stub">
             <div style="font-weight:600; font-size:0.9rem;">KOPAR GÄ°TSÄ°N</div>
             <div class="drag-hint">â¬‡ï¸ AÅŸaÄŸÄ± Ã‡ek â¬‡ï¸</div>
          </div>
        </div>
      </div>

      <div class="bottom-caption" id="bottom-caption">
        Bileti aÅŸaÄŸÄ± Ã§ekerek kopar, film baÅŸlasÄ±n. ğŸ¿
      </div>

    </div>
  </div>

  <audio id="curtain-sound" src="curtain.mp3" preload="auto"></audio>

  <script>
    // --- ELEMENTLER ---
    const video = document.getElementById("love-film");
    const topStartBtn = document.getElementById("top-start-btn");
    const topStart = document.getElementById("top-start");
    const curtain = document.getElementById("curtain");
    const ticketLayer = document.getElementById("ticket-layer");
    const ticketStub = document.getElementById("ticket-stub");
    const ticketVisual = document.getElementById("ticket-visual");
    const bottomCaption = document.getElementById("bottom-caption");
    const curtainSound = document.getElementById("curtain-sound");
    
    const controls = document.getElementById("custom-controls");
    const btnPlay = document.getElementById("btn-play");
    const btnMute = document.getElementById("btn-mute");
    const btnFull = document.getElementById("btn-fullscreen");
    const progressBg = document.getElementById("cc-progress-bg");
    const progressBar = document.getElementById("cc-progress");
    const timeDisplay = document.getElementById("cc-time");
    
    const endOverlay = document.getElementById("end-overlay");
    const btnRewatch = document.getElementById("btn-rewatch");
    const btnSave = document.getElementById("btn-save-ticket");

    const viewerImg = document.getElementById("viewer-scene-img");
    const kissBtn = document.getElementById("kiss-hotspot");

    // --- DEÄÄ°ÅKENLER ---
    let isPlaying = false;
    let isTicketGone = false;

    // --- BÄ°LET SÃœRÃœKLEME ---
    let startY = 0;
    let currentY = 0;
    let isDragging = false;

    ticketStub.addEventListener('touchstart', (e) => {
        startY = e.touches[0].clientY;
        isDragging = true;
    });

    ticketStub.addEventListener('touchmove', (e) => {
        if(!isDragging) return;
        let y = e.touches[0].clientY;
        let diff = y - startY;
        if(diff < 0) diff = 0;
        
        ticketStub.style.transform = `translateY(${diff}px)`;
        
        // Kopma efekti
        if(diff > 100) {
            isDragging = false;
            breakTicket();
        }
    });

    ticketStub.addEventListener('touchend', () => {
        if(isDragging) {
            ticketStub.style.transform = 'translateY(0)';
            isDragging = false;
        }
    });

    // MasaÃ¼stÃ¼ fare desteÄŸi (test iÃ§in)
    ticketStub.addEventListener('mousedown', (e) => {
        startY = e.clientY;
        isDragging = true;
    });
    document.addEventListener('mousemove', (e) => {
        if(!isDragging) return;
        let diff = e.clientY - startY;
        if(diff < 0) diff = 0;
        ticketStub.style.transform = `translateY(${diff}px)`;
        if(diff > 100) {
            isDragging = false;
            breakTicket();
        }
    });
    document.addEventListener('mouseup', () => {
        if(isDragging) {
            ticketStub.style.transform = 'translateY(0)';
            isDragging = false;
        }
    });

    function breakTicket() {
        if(isTicketGone) return;
        isTicketGone = true;
        
        // Bileti dÃ¼ÅŸÃ¼r
        ticketVisual.classList.add('ticket-gone');
        bottomCaption.classList.add('hide');

        // Sesi Ã§al
        if(curtainSound) curtainSound.play().catch(()=>{});

        // Perdeyi aÃ§
        setTimeout(() => {
            curtain.classList.add('open');
            topStart.classList.add('show');
            ticketLayer.style.display = 'none';
        }, 600);
    }

    // --- VÄ°DEO YÃ–NETÄ°MÄ° ---
    // Tek tÄ±kla baÅŸlatma fonksiyonu
    function playMovie() {
        topStart.classList.remove('show');
        video.muted = false; 
        video.play().then(() => {
            isPlaying = true;
            btnPlay.innerText = "â¸";
            document.body.classList.add('lights-dim');
        }).catch(() => {
            // Otomatik ses aÃ§maya izin vermezse sessiz baÅŸlat
            video.muted = true;
            video.play();
            isPlaying = true;
            btnPlay.innerText = "â¸";
            document.body.classList.add('lights-dim');
        });
    }

    // Mobilde "touch" olayÄ± gecikmesiz Ã§alÄ±ÅŸÄ±r
    topStartBtn.addEventListener('click', (e) => {
        e.preventDefault();
        playMovie();
    });
    topStartBtn.addEventListener('touchstart', (e) => {
        e.preventDefault(); // Click'i bekleme
        playMovie();
    }, {passive: false});


    // Video Eventleri
    video.addEventListener('timeupdate', () => {
        if(isNaN(video.duration)) return;
        const pct = (video.currentTime / video.duration) * 100;
        progressBar.style.width = pct + "%";
        
        let curMins = Math.floor(video.currentTime / 60);
        let curSecs = Math.floor(video.currentTime % 60);
        if(curSecs < 10) curSecs = "0" + curSecs;
        timeDisplay.innerText = `${curMins}:${curSecs}`;
    });

    video.addEventListener('ended', () => {
        document.body.classList.remove('lights-dim');
        endOverlay.classList.add('show');
        controls.classList.remove('visible');
    });

    // Kontrolleri gÃ¶ster/gizle
    const screenInner = document.querySelector('.screen-inner');
    let hideTimeout;

    function showControls() {
        controls.classList.add('visible');
        clearTimeout(hideTimeout);
        hideTimeout = setTimeout(() => {
            if(!video.paused) controls.classList.remove('visible');
        }, 2500);
    }

    screenInner.addEventListener('mousemove', showControls);
    screenInner.addEventListener('touchstart', showControls);
    screenInner.addEventListener('click', () => {
        if(video.paused && isPlaying) {
             video.play();
             btnPlay.innerText = "â¸";
        } else if(isPlaying) {
             showControls();
        }
    });

    // Alt butonlar
    btnPlay.addEventListener('click', (e) => {
        e.stopPropagation();
        if(video.paused) {
            video.play();
            btnPlay.innerText = "â¸";
        } else {
            video.pause();
            btnPlay.innerText = "â–¶";
        }
    });

    btnMute.addEventListener('click', (e) => {
        e.stopPropagation();
        video.muted = !video.muted;
        btnMute.innerText = video.muted ? "ğŸ”‡" : "ğŸ”Š";
    });

    btnFull.addEventListener('click', (e) => {
        e.stopPropagation();
        if(video.requestFullscreen) video.requestFullscreen();
        else if(video.webkitRequestFullscreen) video.webkitRequestFullscreen();
    });

    progressBg.addEventListener('click', (e) => {
        e.stopPropagation();
        const rect = progressBg.getBoundingClientRect();
        const pos = (e.clientX - rect.left) / rect.width;
        video.currentTime = pos * video.duration;
    });

    // --- BÄ°TÄ°Å EKRANI BUTONLARI ---
    btnRewatch.addEventListener('click', () => {
        endOverlay.classList.remove('show');
        video.currentTime = 0;
        playMovie();
    });

    btnSave.addEventListener('click', () => {
        const a = document.createElement('a');
        a.href = 'bilet.png';
        a.download = 'HatÄ±ra_Bileti.png';
        document.body.appendChild(a);
        a.click();
        a.remove();
    });

    // --- Ã–PÃœCÃœK EFEKTÄ° ---
    if(kissBtn) {
        kissBtn.addEventListener('click', () => {
            viewerImg.src = "salon-kiss.png";
            setTimeout(() => {
                viewerImg.src = "salon.png";
            }, 2000);
        });
    }

  </script>
</body>
</html>
